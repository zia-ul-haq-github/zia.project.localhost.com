"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[6966],{3396:function(Me,ie,n){n.r(ie),n.d(ie,{default:function(){return Ge}});var ve=n(97857),se=n.n(ve),me=n(5574),Q=n.n(me),pe=n(15009),s=n.n(pe),fe=n(99289),z=n.n(fe),ge=n(6110),w=n(34994),xe=n(2236),Y=n(38345),E=n(5966),ye=n(90672),je=n(21134),W=n(64317),R=n(5155),G=n(2453),k=n(47019),Se=n(71230),ae=n(15746),L=n(83622),le=n(51042),Ce=n(57619),I=n(67294),$=n(76772),Pe=n(91319),ze=n(47389),we=n(27484),oe=n.n(we),ue=n(37476),Ue=n(15623),e=n(85893),Fe=function(d){var r=d.visible,S=d.onVisiblityChange,c=d.onFinish,q=d.quizID,F=d.authorID,p=k.Z.useForm(),C=Q()(p,1),D=C[0],P=(0,I.useState)([]),V=Q()(P,2),B=V[0],Z=V[1],f={choices:[{choice:void 0}]};return(0,e.jsx)(ue.Y,{form:D,open:r,onOpenChange:function(h){h||S(h)},modalProps:{destroyOnClose:!0,getContainer:function(){document.body},width:1200,okText:"Create"},submitter:{resetButtonProps:{style:{}},submitButtonProps:{style:{}}},grid:!0,initialValues:f,onFieldsChange:function(){var a=z()(s()().mark(function h(u,l){var t;return s()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:console.log("changedFieldName = ",u[0].name),u&&u[0].name.includes("choices")&&(t=D.getFieldValue("choices"),console.log("choices",t),Z(t));case 2:case"end":return o.stop()}},h)}));return function(h,u){return a.apply(this,arguments)}}(),preserve:!1,submitTimeout:2e3,onFinish:function(){var a=z()(s()().mark(function h(u){var l;return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return l={quiz_id:q,author_id:F,title:u==null?void 0:u.title,choices:u==null?void 0:u.choices,answer:u==null?void 0:u.answer},(0,$.request)("/api/questions",{method:"POST",data:l}).then(function(){var o=z()(s()().mark(function x(A){var v;return s()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:(A==null||(v=A.data)===null||v===void 0?void 0:v.id)>0?(c({status:!0,text_message:"Question created successfully"}),S(!1)):c({status:!1,text_message:"Failed to create Question: Invalid response"});case 1:case"end":return b.stop()}},x)}));return function(x){return o.apply(this,arguments)}}()).catch(function(o){console.log(o)}),i.abrupt("return",!0);case 3:case"end":return i.stop()}},h)}));return function(h){return a.apply(this,arguments)}}(),children:(0,e.jsxs)(Y.Z,{title:"Create Question",bordered:!0,headerBordered:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},children:[(0,e.jsx)(w.A.Group,{size:24,children:(0,e.jsx)(E.Z,{name:"title",label:"Title",placeholder:"Type Question Title",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})}),(0,e.jsx)(w.A.Group,{size:24,children:(0,e.jsx)(R.u,{name:"choices",min:1,max:4,copyIconProps:{tooltipText:"Copy this choice"},deleteIconProps:{tooltipText:"Delete this choice"},creatorButtonProps:{creatorButtonText:"Add New Choice"},children:(0,e.jsx)(w.A.Group,{size:24,children:(0,e.jsx)(E.Z,{name:"choice",label:"Choice",placeholder:"Type Your Choice",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})})}),(0,e.jsx)(w.A.Group,{size:24,children:(0,e.jsx)(W.Z,{name:"answer",label:"Answer",showSearch:!0,params:{selected_choices:B},request:function(){var a=z()(s()().mark(function h(u){var l;return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return l=u==null?void 0:u.selected_choices.map(function(o,x){return{label:o==null?void 0:o.choice,value:(o==null?void 0:o.choice).trim().replace(/\s+/g,"-").toLowerCase()}}),console.log("options",l),i.abrupt("return",l);case 3:case"end":return i.stop()}},h)}));return function(h){return a.apply(this,arguments)}}(),debounceTime:300,placeholder:"Please Select a Answer",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})]})})},be=Fe,Te=function(d){var r=d.visible,S=d.onVisiblityChange,c=d.editModelData,q=d.onFinish,F=k.Z.useForm(),p=Q()(F,1),C=p[0],D=(0,I.useState)([]),P=Q()(D,2),V=P[0],B=P[1];return(0,e.jsx)(ue.Y,{open:r,onOpenChange:function(f){f||S(f)},modalProps:{destroyOnClose:!0,getContainer:function(){document.body},width:1200,okText:"Update"},submitter:{resetButtonProps:{style:{}},submitButtonProps:{style:{}}},grid:!0,onFieldsChange:function(){var Z=z()(s()().mark(function f(a,h){var u;return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("changedFieldName = ",a[0].name),a&&a[0].name.includes("choices")&&(u=C.getFieldValue("choices"),console.log("choices",u),B(u));case 2:case"end":return t.stop()}},f)}));return function(f,a){return Z.apply(this,arguments)}}(),preserve:!1,submitTimeout:2e3,onFinish:function(){var Z=z()(s()().mark(function f(a){var h;return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return h={quiz_id:quizID,author_id:authorID,title:a==null?void 0:a.title,choices:a==null?void 0:a.choices,answer:a==null?void 0:a.answer},(0,$.request)("/api/questions/"+(c==null?void 0:c.id),{method:"PUT",data:h}).then(function(){var t=z()(s()().mark(function i(o){var x;return s()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:(o==null||(x=o.data)===null||x===void 0?void 0:x.id)>0?(q({status:!0,text_message:"Question updated successfully"}),S(!1)):q({status:!1,text_message:"Failed to update Question: Invalid response"});case 1:case"end":return v.stop()}},i)}));return function(i){return t.apply(this,arguments)}}()).catch(function(t){console.log(t)}),l.abrupt("return",!0);case 3:case"end":return l.stop()}},f)}));return function(f){return Z.apply(this,arguments)}}(),children:(0,e.jsxs)(Y.Z,{title:"Edit Question",bordered:!0,headerBordered:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},children:[(0,e.jsx)(w.A.Group,{size:24,children:(0,e.jsx)(E.Z,{name:"title",label:"Title",initialValue:c==null?void 0:c.title,placeholder:"Type Question Title",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})}),(0,e.jsx)(w.A.Group,{size:24,children:(0,e.jsx)(R.u,{name:"choices",min:1,max:4,initialValue:c==null?void 0:c.choices,copyIconProps:{tooltipText:"Copy this choice"},deleteIconProps:{tooltipText:"Delete this choice"},creatorButtonProps:{creatorButtonText:"Add New Choice"},children:(0,e.jsx)(w.A.Group,{size:24,children:(0,e.jsx)(E.Z,{name:"choice",label:"Choice",placeholder:"Type Your Choice",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})})}),(0,e.jsx)(w.A.Group,{size:24,children:(0,e.jsx)(W.Z,{name:"answer",label:"Answer",initialValue:c==null?void 0:c.answer,showSearch:!0,params:{selected_choices:V},request:function(){var Z=z()(s()().mark(function f(a){var h;return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return h=a==null?void 0:a.selected_choices.map(function(t,i){return{label:t==null?void 0:t.choice,value:(t==null?void 0:t.choice).trim().replace(/\s+/g,"-").toLowerCase()}}),console.log("options",h),l.abrupt("return",h);case 3:case"end":return l.stop()}},f)}));return function(f){return Z.apply(this,arguments)}}(),debounceTime:300,placeholder:"Please Select a Answer",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})]})})},Ie=Te,Ze=n(86738),De=n(63783),Ae=n(82061),Qe=function(d){var r=d.rowId,S=d.onFinish;return(0,e.jsx)(Ze.Z,{title:"Delete the Question",description:"Are you sure you want to delete this Question?",icon:(0,e.jsx)(De.Z,{style:{color:"red"}}),placement:"left",onConfirm:z()(s()().mark(function c(){return s()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,(0,$.request)("/api/questions/"+r,{method:"DELETE"}).then(function(p){p.status===!0?S({status:!0,text_message:"Question deleted successfully"}):S({status:!1,text_message:"Failed to delete Question: Invalid response"})});case 2:return F.abrupt("return",F.sent);case 3:case"end":return F.stop()}},c)})),okText:"Yes",cancelText:"No",children:(0,e.jsx)(L.ZP,{danger:!0,children:(0,e.jsx)(Ae.Z,{})},"deletable")})},$e=Qe,Ve=function(d){var r=d.questionsTableRef,S=d.quizID,c=d.authorID,q=(0,I.useState)(!1),F=Q()(q,2),p=F[0],C=F[1],D=(0,I.useState)(!1),P=Q()(D,2),V=P[0],B=P[1],Z=(0,I.useState)({}),f=Q()(Z,2),a=f[0],h=f[1],u=[{title:"ID",dataIndex:"id",key:"table-column-id",hideInSearch:!0,sorter:!0,defaultSortOrder:"descend"},{title:"Title",dataIndex:"title",key:"table-column-title",hideInSearch:!0},{title:"Created Date",dataIndex:"created_at",key:"table-column-created-date",sorter:!0,hideInForm:!0,hideInSearch:!0,render:function(t){return(0,e.jsx)("p",{children:oe()(new Date(t)).format("DD-MM-YYYY")})}},{title:"Updated Date",dataIndex:"updated_at",key:"table-column-updated-date",sorter:!0,hideInForm:!0,hideInSearch:!0,render:function(t){return(0,e.jsx)("p",{children:oe()(new Date(t)).format("DD-MM-YYYY")})}},{title:"Actions",valueType:"option",key:"table-column-actions",render:function(t,i,o,x){return[(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(L.ZP,{onClick:function(){h(i),B(!0)},children:(0,e.jsx)(ze.Z,{})},"editable"),",",(0,e.jsx)($e,{rowId:i==null?void 0:i.id,onFinish:function(v){var U=v.status,b=v.text_message;if(U){var y;G.ZP.success(b),(y=r.current)===null||y===void 0||y.reload()}else G.ZP.error(b)}}),","]})]}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Y.Z,{title:"Question Details",bordered:!0,headerBordered:!0,collapsible:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},children:(0,e.jsx)(Pe.Z,{actionRef:r,rowKey:"id",search:!1,options:!1,pagination:{defaultPageSize:10,showSizeChanger:!0,pageSizeOptions:[10,20,50,100]},toolBarRender:function(){return[(0,e.jsxs)(L.ZP,{type:"primary",onClick:function(){C(!0)},children:[(0,e.jsx)(le.Z,{})," New"]},"new")]},request:z()(s()().mark(function l(){var t,i,o,x,A,v=arguments;return s()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return t=v.length>0&&v[0]!==void 0?v[0]:{},i=v.length>1?v[1]:void 0,o=v.length>2?v[2]:void 0,x=v.length>3?v[3]:void 0,b.next=6,(0,$.request)("/api/questions",{params:{page:t==null?void 0:t.current,per_page:t==null?void 0:t.pageSize,order_by:"id",order:"desc"}}).catch(function(y){console.log(y)});case 6:return A=b.sent,b.abrupt("return",{data:A.data.data,total:A.data.total,current_page:A.data.current_page});case 8:case"end":return b.stop()}},l)})),columns:u})}),(0,e.jsx)(be,{visible:p,onVisiblityChange:function(t){var i=t.VisiblityStatus;C(i)},onFinish:function(t){var i=t.status,o=t.text_message;if(i){var x;G.ZP.success(o),(x=r.current)===null||x===void 0||x.reload()}else G.ZP.error(o)},quizID:S,authorID:c}),(0,e.jsx)(Ie,{visible:V,onVisiblityChange:function(t){var i=t.VisiblityStatus;B(i)},editModelData:a,onFinish:function(t){var i=t.status,o=t.text_message;if(i){var x;G.ZP.success(o),(x=r.current)===null||x===void 0||x.reload()}else G.ZP.error(o)}})]})},Be=Ve,de=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return new Promise(function(r){setTimeout(function(){r(!0)},d)})},ce={title:"",description:"",status:"",passing_percentage:"",attempts_limit:"",class_id:"",users:""},qe=function(){var M=z()(s()().mark(function d(r,S){var c,q;return s()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return console.log("onFinishHandlerForm"),console.log("Received values of form: ",r),p.prev=2,q={title:r==null?void 0:r.title,description:r==null?void 0:r.description,status:r==null?void 0:r.status,passing_percentage:r==null?void 0:r.passing_percentage,attempts_limit:r==null?void 0:r.attempts_limit,author_id:S,class_id:r==null?void 0:r.class_id,users:(r==null||(c=r.users)===null||c===void 0?void 0:c.map(function(C){return C==null?void 0:C.user}))||[]},p.next=6,(0,$.request)("/api/quizzes/"+(r==null?void 0:r.quiz_id),{method:"PUT",data:q}).then(function(){var C=z()(s()().mark(function D(P){var V,B;return s()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:(P==null||(V=P.data)===null||V===void 0?void 0:V.id)>0&&(G.ZP.success("Submitted successfully"),$.history.push("/tutor-app/quizzes/edit/"+(P==null||(B=P.data)===null||B===void 0?void 0:B.id)));case 1:case"end":return f.stop()}},D)}));return function(D){return C.apply(this,arguments)}}()).catch(function(C){console.log(C)});case 6:return p.abrupt("return",p.sent);case 9:p.prev=9,p.t0=p.catch(2),console.log("api_response - error"),console.log(p.t0);case 13:return p.abrupt("return",!0);case 14:case"end":return p.stop()}},d,null,[[2,9]])}));return function(r,S){return M.apply(this,arguments)}}(),Ee=function(){var d=(0,$.useParams)(),r=(0,$.useModel)("@@initialState"),S=r.initialState,c=r.loading,q=r.refresh,F=r.setInitialState,p=(0,I.useState)(0),C=Q()(p,2),D=C[0],P=C[1],V=k.Z.useForm(),B=Q()(V,1),Z=B[0],f=(0,I.useRef)(),a=(0,I.useState)([]),h=Q()(a,2),u=h[0],l=h[1],t=(0,I.useState)([]),i=Q()(t,2),o=i[0],x=i[1],A=(0,I.useState)(0),v=Q()(A,2),U=v[0],b=v[1];return(0,I.useEffect)(function(){var y;P(S==null||(y=S.currentUser)===null||y===void 0?void 0:y.id)},[]),(0,I.useEffect)(function(){b(d.id)},[]),(0,I.useEffect)(function(){return(0,$.request)("/api/classes",{}).then(function(y){var j=y.data.data.map(function(m,H){return{value:m==null?void 0:m.id,label:m==null?void 0:m.title}});return l(j),j})},[]),(0,I.useEffect)(function(){return(0,$.request)("/api/users",{params:{role:"user",page:1,per_page:1e3}}).then(function(y){var j=y.data.data.map(function(m,H){return{value:m==null?void 0:m.id,label:m==null?void 0:m.name}});return x(j),j})},[]),(0,e.jsxs)(ge._z,{children:[(0,e.jsxs)(Se.Z,{gutter:{xs:8,sm:16,md:24,lg:32},children:[(0,e.jsx)(ae.Z,{flex:"auto"}),(0,e.jsx)(ae.Z,{flex:"100px",children:(0,e.jsxs)(L.ZP,{type:"primary",onClick:function(){$.history.push("/tutor-app/quizzes/new")},style:{marginBlockEnd:15},children:[(0,e.jsx)(le.Z,{})," New"]},"new")})]}),(0,e.jsxs)(w.A,{layout:"vertical",grid:!0,initialValues:ce,form:Z,params:{quiz_id:U},request:z()(s()().mark(function y(){var j,m=arguments;return s()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(j=m.length>0&&m[0]!==void 0?m[0]:{},(j==null?void 0:j.quiz_id)!=0){T.next=3;break}return T.abrupt("return");case 3:return T.next=5,de(2e3);case 5:return T.next=7,(0,$.request)("/api/quizzes/"+(j==null?void 0:j.quiz_id),{method:"GET"}).then(function(){var K=z()(s()().mark(function he(g){var J,X,_,ee,te,re,O;return s()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.abrupt("return",se()(se()({},ce),{},{title:g==null||(J=g.data)===null||J===void 0?void 0:J.title,description:g==null||(X=g.data)===null||X===void 0?void 0:X.description,status:g==null||(_=g.data)===null||_===void 0?void 0:_.status,passing_percentage:g==null||(ee=g.data)===null||ee===void 0?void 0:ee.passing_percentage,attempts_limit:g==null||(te=g.data)===null||te===void 0?void 0:te.attempts_limit,class_id:g==null||(re=g.data)===null||re===void 0?void 0:re.class_id,users:(g==null||(O=g.data)===null||O===void 0||(O=O.users)===null||O===void 0?void 0:O.map(function(ne){return{user:ne==null?void 0:ne.id}}))||[]}));case 1:case"end":return N.stop()}},he)}));return function(he){return K.apply(this,arguments)}}()).catch(function(K){console.log(K)});case 7:return T.abrupt("return",T.sent);case 8:case"end":return T.stop()}},y)})),onFinish:function(){var y=z()(s()().mark(function j(m){return s()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,de(2e3);case 2:return m.quiz_id=U,m.author_id=D,T.next=6,qe(m,D);case 6:case"end":return T.stop()}},j)}));return function(j){return y.apply(this,arguments)}}(),submitter:{render:function(j,m){return(0,e.jsx)(xe.S,{children:m})}},children:[(0,e.jsxs)(Y.Z,{title:"Quiz Details",bordered:!0,headerBordered:!0,collapsible:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},onCollapse:function(j){return console.log(j)},children:[(0,e.jsx)(w.A.Group,{size:24,children:(0,e.jsx)(E.Z,{name:"title",label:"Title",placeholder:"Type Quiz Title",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})}),(0,e.jsx)(w.A.Group,{size:24,children:(0,e.jsx)(ye.Z,{name:"description",label:"Description",fieldProps:{rows:6},placeholder:"Share a little description to fill out your quiz.",colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})}),(0,e.jsxs)(w.A.Group,{size:24,children:[(0,e.jsx)(je.Z,{name:"status",label:"Status",initialValue:"in-active",valueEnum:{"in-active":"In-Active",active:"Active"},colProps:{xs:24,sm:24,md:8,lg:8,xl:8}}),(0,e.jsx)(E.Z,{name:"passing_percentage",label:"Passing Percentage",placeholder:"Type Passing Percentage",rules:[{required:!0}],fieldProps:{suffix:(0,e.jsx)(Ce.Z,{})},colProps:{xs:24,sm:24,md:8,lg:8,xl:8}}),(0,e.jsx)(E.Z,{name:"attempts_limit",label:"Attempts Limit",placeholder:"Type Attempts Limit",rules:[{required:!0}],colProps:{xs:24,sm:24,md:8,lg:8,xl:8}})]}),(0,e.jsx)(w.A.Group,{size:24,children:(0,e.jsx)(W.Z,{name:"class_id",label:"Classes",showSearch:!0,options:u,debounceTime:300,placeholder:"Please Select a Class",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})]}),(0,e.jsx)(Y.Z,{title:"Assign Users",bordered:!0,headerBordered:!0,collapsible:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},children:(0,e.jsx)(w.A.Group,{size:24,children:(0,e.jsx)(R.u,{name:"users",min:1,copyIconProps:{tooltipText:"Copy this user"},deleteIconProps:{tooltipText:"Delete this user"},creatorButtonProps:{creatorButtonText:"Add New User"},children:(0,e.jsx)(w.A.Group,{size:24,children:(0,e.jsx)(W.Z,{name:"user",label:"User",showSearch:!0,options:o,debounceTime:300,placeholder:"Please Select a User",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})})})}),(0,e.jsx)(Be,{questionsTableRef:f,quizID:U,authorID:D}),","]})]})},Ge=Ee}}]);
