"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[135],{76955:function(le,S,r){r.r(S);var F=r(15009),l=r.n(F),$=r(97857),M=r.n($),V=r(99289),j=r.n(V),k=r(5574),b=r.n(k),T=r(88641),O=r(94149),G=r(87547),N=r(68262),v=r(5966),E=r(76772),H=r(40056),Q=r(2453),Y=r(11941),J=r(67610),U=r(67294),X=r(73935),q=r(14521),e=r(85893),ee=(0,q.kc)(function(x){var g=x.token;return{action:{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:g.colorPrimaryActive}},container:{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"},main:{padding:"0px !important",margin:"10px"}}}),L=function(g){var A=g.content;return(0,e.jsx)(H.Z,{style:{marginBottom:24},message:A,type:"error",showIcon:!0})},re=function(){var g,A=(0,U.useState)({}),C=b()(A,2),B=C[0],ie=C[1],se=(0,U.useState)("sign-in"),W=b()(se,2),y=W[0],ne=W[1],R=(0,E.useModel)("@@initialState"),i=R.initialState,K=R.setInitialState,oe=ee(),I=oe.styles,_e=(0,E.useIntl)(),ue=function(){var h=j()(l()().mark(function _(){var o,u;return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return console.log("auth - fetchUserInfo"),a.next=3,i==null||(o=i.fetchUserInfo)===null||o===void 0?void 0:o.call(i);case 3:u=a.sent,console.log("auth - userInfo"),console.log(u),u?(console.log("auth - userInfo - case - 01"),(0,X.flushSync)(function(){console.log("auth - userInfo - case - 02"),K(function(m){return M()(M()({},m),{},{currentUser:u})})})):console.log("auth - userInfo - case - 03"),console.log("auth - initialState"),console.log(i);case 9:case"end":return a.stop()}},_)}));return function(){return h.apply(this,arguments)}}(),ae=function(){var h=j()(l()().mark(function _(o){var u,s,a,m,P,d,c,Z;return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("handleSubmit"),console.log("values"),console.log(o),n.prev=3,d="",!((o==null||(u=o.name)===null||u===void 0?void 0:u.length)>0)){n.next=11;break}return o.role="user",n.next=9,(0,E.request)("/api/auth/register",{method:"POST",data:o}).then(function(){var p=j()(l()().mark(function D(t){return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:console.log("api_response"),console.log(t),t!=null&&t.status&&(d=t);case 3:case"end":return f.stop()}},D)}));return function(D){return p.apply(this,arguments)}}()).catch(function(p){console.log(p)});case 9:n.next=13;break;case 11:return n.next=13,(0,E.request)("/api/auth/login",{method:"POST",data:o}).then(function(){var p=j()(l()().mark(function D(t){return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:console.log("api_response"),console.log(t),t!=null&&t.status&&(d=t);case 3:case"end":return f.stop()}},D)}));return function(D){return p.apply(this,arguments)}}()).catch(function(p){console.log(p)});case 13:if(console.log("laravel_api_bearer_token"),console.log((s=d)===null||s===void 0||(s=s.data)===null||s===void 0||(s=s.access_token)===null||s===void 0?void 0:s.text),localStorage.setItem("laravel_api_bearer_token",(a=d)===null||a===void 0||(a=a.data)===null||a===void 0||(a=a.access_token)===null||a===void 0?void 0:a.text),console.log("after - redirect - logged_user_api_response?.data?.user"),console.log((m=d)===null||m===void 0||(m=m.data)===null||m===void 0?void 0:m.user),K(M()(M()({},i),{},{currentUser:(P=d)===null||P===void 0||(P=P.data)===null||P===void 0?void 0:P.user,refresh:function(){return!0}})),console.log("before - redirect - initialState"),console.log(i),d.status!==!0){n.next=26;break}return window.location="/"+((c=d)===null||c===void 0||(c=c.data)===null||c===void 0||(c=c.user)===null||c===void 0?void 0:c.role)+"-app/dashboard",n.abrupt("return");case 26:return E.history.push("/authentication"),n.abrupt("return");case 28:n.next=35;break;case 30:n.prev=30,n.t0=n.catch(3),Z="Login failed, please try again!",console.log(n.t0),Q.ZP.error(Z);case 35:case"end":return n.stop()}},_,null,[[3,30]])}));return function(o){return h.apply(this,arguments)}}(),w=B.status,z=B.type;return(0,e.jsxs)("div",{className:I==null?void 0:I.container,children:[(0,e.jsx)(E.Helmet,{children:(0,e.jsx)("title",{children:J.Z.title})}),(0,e.jsx)("div",{style:{flex:"1"},children:(0,e.jsxs)(N.U,{contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,e.jsx)("img",{alt:"logo",src:i==null||(g=i.settings)===null||g===void 0?void 0:g.logo}),title:"Online Tutor Finding Application",subTitle:"Your ultimate online tutor finding application.",onFinish:function(){var h=j()(l()().mark(function _(o){return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,ae(o);case 2:case"end":return s.stop()}},_)}));return function(_){return h.apply(this,arguments)}}(),children:[(0,e.jsx)(Y.Z,{activeKey:y,onChange:ne,centered:!0,items:[{key:"sign-in",label:"Sign in"},{key:"sign-up",label:"Sign Up"}]}),w==="error"&&z==="sign-in"&&(0,e.jsx)(L,{content:"Wrong username or password"}),y==="sign-in"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(v.Z,{name:"email",fieldProps:{size:"large",prefix:(0,e.jsx)(T.Z,{})},placeholder:"zia@example.com",rules:[{required:!0,message:"please enter user name!"}]}),(0,e.jsx)(v.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,e.jsx)(O.Z,{}),max:10,min:6},placeholder:"Type password",rules:[{required:!0,message:"Please enter your password!"}]})]}),w==="error"&&z==="sign-up"&&(0,e.jsx)(L,{content:"Verification code error"}),y==="sign-up"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(v.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(G.Z,{})},name:"name",placeholder:"Enter Full Name",rules:[{required:!0,message:"Please enter name!"}]}),(0,e.jsx)(v.Z,{fieldProps:{size:"large",prefix:(0,e.jsx)(T.Z,{})},name:"email",placeholder:"Enter your Email",rules:[{required:!0,message:"Please enter email!"}]}),(0,e.jsx)(v.Z.Password,{fieldProps:{size:"large",prefix:(0,e.jsx)(O.Z,{}),max:10,min:6},name:"password",placeholder:"Enter Password",rules:[{required:!0,message:"Please enter password!"}]}),(0,e.jsx)(v.Z.Password,{name:"password_confirmation",dependencies:["password"],fieldProps:{size:"large",prefix:(0,e.jsx)(O.Z,{}),max:10,min:6},placeholder:"Enter Confirm Password",rules:[{required:!0,message:"Please confirm your password!"},function(h){var _=h.getFieldValue;return{validator:function(u,s){return!s||_("password")===s?Promise.resolve():Promise.reject(new Error("The new password that you entered do not match!"))}}}]})]}),(0,e.jsx)("div",{style:{marginBottom:24}})]})})]})};S.default=re}}]);
